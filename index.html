<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
    <script type="module">
        import QrScanner from "https://unpkg.com/qr-scanner/qr-scanner.min.js";
        QrScanner.WORKER_PATH = 'https://unpkg.com/qr-scanner/qr-scanner-worker.min.js';

        window.addEventListener('load', () => {
            const video = document.getElementById('qr-video');
            const qrScanner = new QrScanner(video, result => {
                console.log('decoded qr code:', result);
                sendDataToGoogleSheet(result);
            });
            qrScanner.start();
        });

        function sendDataToGoogleSheet(data) {
            fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: 'data=' + encodeURIComponent(data)
            })
            .then(response => response.text())
            .then(result => console.log(result))
            .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <video id="qr-video" width="320" height="240" style="border: 1px solid black;"></video>
</body>
</html>
